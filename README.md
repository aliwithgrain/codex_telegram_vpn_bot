# codex_telegram_vpn_bot

Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø´ØªØ±Ø§Ú© VPN Ø¨Ø§ 3x-uiØŒ Ø·Ø±Ø§Ø­ÛŒâ€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù†ØµØ¨ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø³ØªÙ‚Ù„.

---

## Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§

* Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ø§ ÙˆÛŒØ²Ø§Ø±Ø¯ (`npm run setup`) Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª/Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ `.env`
* ÙØ§ÛŒÙ„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÙˆÛŒØ§ (`config/runtime.config.json`) Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ù„Ù†â€ŒÙ‡Ø§ Ùˆ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ú©Ø¯
* Ø§Ø¨Ø²Ø§Ø± CLI Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ù„Ù†â€ŒÙ‡Ø§ Ùˆ Ø¢Ø³ØªØ§Ù†Ù‡â€ŒÛŒ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§
* Ø§Ù…Ú©Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø§Ø¦Ù…ÛŒ Ø¨Ø§ **PM2**
* Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù†ØªÛŒÙ†Ø±ÛŒ Ø¨Ø§ **Docker**

---

## Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§

* **Ubuntu 24.04** (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ VPS)
* **Node.js 20+**
* **npm**
* **Bot Token** ØªÙ„Ú¯Ø±Ø§Ù… (Ø§Ø² BotFather)
* **Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù¾Ù†Ù„ 3x-ui**
* (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) **Docker + Docker Compose** Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù†ØªÛŒÙ†Ø±ÛŒ

> Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¯Ù‚ÛŒÙ‚ Ù…Ø­ÛŒØ·ÛŒ Ø±Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¯Ø± ÙØ§ÛŒÙ„ `.env.example` Ø¯Ø§Ø®Ù„ Ø±ÛŒÙ¾Ùˆ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø±Ø¯.

---

## Ù†ØµØ¨ Ø±ÙˆÛŒ VPS (Ú¯Ø§Ù…â€ŒØ¨Ù‡â€ŒÚ¯Ø§Ù…)

### 1ï¸âƒ£ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³ÛŒØ³ØªÙ… Ùˆ Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y curl git ca-certificates
```

---

### 2ï¸âƒ£ Ù†ØµØ¨ Node.js 20 LTS

```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs
```

---

### 3ï¸âƒ£ Ø¨Ø±Ø±Ø³ÛŒ Ù†Ø³Ø®Ù‡ Node & npm

```bash
node -v
npm -v
```

> Ù†Ø³Ø®Ù‡ Node Ø¨Ø§ÛŒØ¯ **20 ÛŒØ§ Ø¨Ø§Ù„Ø§ØªØ±** Ø¨Ø§Ø´Ø¯.

---

### 4ï¸âƒ£ Ø¯Ø±ÛŒØ§ÙØª Ø³ÙˆØ±Ø³ Ù¾Ø±ÙˆÚ˜Ù‡

```bash
git clone https://github.com/aliwithgrain/codex_telegram_vpn_bot.git
cd codex_telegram_vpn_bot
```

---

### 5ï¸âƒ£ Ù†ØµØ¨ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§

```bash
npm ci
```

Ø§Ú¯Ø± `npm ci` Ø®Ø·Ø§ Ø¯Ø§Ø¯ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ù‡ Ø®Ø§Ø·Ø± lockfile Ù†Ø§Ø³Ø§Ø²Ú¯Ø§Ø±)ØŒ Ø§Ø² Ø§ÛŒÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:

```bash
npm install
```

---

### 6ï¸âƒ£ Ø§Ø¬Ø±Ø§ÛŒ ÙˆÛŒØ²Ø§Ø±Ø¯ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ (Ø³Ø§Ø®Øª `.env`)

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `setup` Ø¯Ø± `package.json` ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

```bash
npm run setup
```

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `setup` Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø¨ÙˆØ¯:

```bash
node src/setup.js
```

Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹:

* Bot TokenØŒ admin IDsØŒ Ù¾Ù†Ù„ 3x-ui Ùˆ Ø³Ø§ÛŒØ± Ù…ØªØºÛŒØ±Ù‡Ø§ Ø±Ø§ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
* ÙØ§ÛŒÙ„ `.env` Ø±Ø§ Ù…ÛŒâ€ŒØ³Ø§Ø²Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
* ÙØ§ÛŒÙ„ Ø§ÙˆÙ„ÛŒÙ‡â€ŒÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÙˆÛŒØ§ Ø±Ø§ Ø¯Ø± `config/runtime.config.json` Ù…ÛŒâ€ŒØ³Ø§Ø²Ø¯

---

### 7ï¸âƒ£ Ø§Ø¬Ø±Ø§ÛŒ Ø±Ø¨Ø§Øª

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `start` ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

```bash
npm run start
```

Ø¯Ø± ØºÛŒØ± Ø§ÛŒÙ† ØµÙˆØ±Øª:

```bash
node src/index.js
```

---

## Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯

Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ ØªØ¹Ø±ÛŒÙâ€ŒØ´Ø¯Ù‡ Ø¯Ø± `package.json`:

```bash
npm run
```

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `check` ÛŒØ§ `test` ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¢Ù†â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:

```bash
npm run check
npm test
```

---

## Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ù„Ù†â€ŒÙ‡Ø§ Ùˆ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ (CLI)

### ğŸ“Š Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª Ù¾Ù„Ù†â€ŒÙ‡Ø§

```bash
npm run plans -- list
```

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `plans` Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø¨ÙˆØ¯:

```bash
node src/manage-plans.js list
```

---

### â• Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ù„Ù†

```bash
npm run plans -- add pro-50gb "Ù¾Ù„Ù† Ù¾Ø±Ùˆ" 30 50 349000
```

ÛŒØ§:

```bash
node src/manage-plans.js add pro-50gb "Ù¾Ù„Ù† Ù¾Ø±Ùˆ" 30 50 349000
```

---

### â›” ØºÛŒØ±ÙØ¹Ø§Ù„/ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù¾Ù„Ù†

```bash
npm run plans -- disable pro-50gb
npm run plans -- enable pro-50gb
```

ÛŒØ§:

```bash
node src/manage-plans.js disable pro-50gb
node src/manage-plans.js enable pro-50gb
```

---

### âŒ Ø­Ø°Ù Ù¾Ù„Ù†

```bash
npm run plans -- remove pro-50gb
```

ÛŒØ§:

```bash
node src/manage-plans.js remove pro-50gb
```

---

### âš™ ØªÙ†Ø¸ÛŒÙ… Ø¢Ø³ØªØ§Ù†Ù‡â€ŒÙ‡Ø§ Ùˆ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§

```bash
npm run plans -- set-threshold 10
npm run plans -- set-expiry-warning 2
```

ÛŒØ§:

```bash
node src/manage-plans.js set-threshold 10
node src/manage-plans.js set-expiry-warning 2
```

---

## Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø§Ø¦Ù…ÛŒ Ø¨Ø§ PM2

### Ù†ØµØ¨ PM2

```bash
sudo npm i -g pm2
```

---

### Ø§Ø¬Ø±Ø§ÛŒ Ø±Ø¨Ø§Øª Ø¨Ø§ PM2

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `start` ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

```bash
pm2 start npm --name telegram-vpn-bot -- run start
```

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `start` ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯:

```bash
pm2 start src/index.js --name telegram-vpn-bot
```

---

### Ø¯Ø³ØªÙˆØ±Ù‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ PM2

```bash
pm2 status
pm2 logs telegram-vpn-bot
pm2 restart telegram-vpn-bot
pm2 save
pm2 startup
```

---

## Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø§ Docker

Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²:

* Docker
* Docker Compose

Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡:

```bash
docker compose up -d --build
```

Ù†Ú©ØªÙ‡:

* Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ DockerØŒ ÙØ§ÛŒÙ„ `.env` Ø¨Ø§ÛŒØ¯ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯.
* Ù¾Ø³ Ø§Ø² Ø§Ø¹Ù…Ø§Ù„ ØªØºÛŒÛŒØ±Ø§Øª Ú©Ø§Ù†ÙÛŒÚ¯ØŒ Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¨Ø³Ø§Ø²ÛŒØ¯.

---

## Ù†ØµØ¨ Ø±ÙˆÛŒ aaPanel

Û±) ÛŒÚ© Ù¾Ø±ÙˆÚ˜Ù‡ Node.js Ø¨Ø³Ø§Ø²ÛŒØ¯
Û²) Ø³ÙˆØ±Ø³ Ø±ÛŒÙ¾Ùˆ Ø±Ø§ Deploy Ú©Ù†ÛŒØ¯
Û³) Ø¯Ø± ØªØ±Ù…ÛŒÙ†Ø§Ù„ Ù¾Ø±ÙˆÚ˜Ù‡:

```bash
npm ci || npm install
```

Û´) ÙˆÛŒØ²Ø§Ø±Ø¯ setup Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
npm run setup || node src/setup.js
```

Ûµ) Command Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ:

Ø§Ú¯Ø± Ø§Ø³Ú©Ø±ÛŒÙ¾Øª `start` ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯:

```
npm run start
```

Ø¯Ø± ØºÛŒØ± Ø§ÛŒÙ† ØµÙˆØ±Øª:

```
node src/index.js
```

---

## ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

* `src/index.js`: Ù†Ù‚Ø·Ù‡ Ø´Ø±ÙˆØ¹ Ø±Ø¨Ø§Øª
* `src/setup.js`: ÙˆÛŒØ²Ø§Ø±Ø¯ Ù†ØµØ¨ Ùˆ ØªÙˆÙ„ÛŒØ¯ `.env`
* `src/manage-plans.js`: Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ù„Ù†â€ŒÙ‡Ø§ (CLI)
* `src/lib/runtime-config.js`: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ/Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÙˆÛŒØ§
* `.env.example`: Ù†Ù…ÙˆÙ†Ù‡ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ
* `config/runtime.config.example.json`: Ù†Ù…ÙˆÙ†Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÙˆÛŒØ§
* `install.sh`: Ù†ØµØ¨ Ø³Ø±ÛŒØ¹ (Ø¯Ø± ØµÙˆØ±Øª Ù…ÙˆØ¬ÙˆØ¯)
* `PROJECT_SPEC_FA.md`: Ù…Ø´Ø®ØµØ§Øª Ù…Ø­ØµÙˆÙ„

---

## Ù†Ú©Ø§Øª Ù…ÙÛŒØ¯

ğŸ“Œ Ø§Ú¯Ø± Ø¨Ø¹Ø¯ Ø§Ø² Merge Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯ÛŒØ¯ØŒ Ø§ÛŒÙ† Ú†Ù†Ø¯ ÙØ±Ù…Ø§Ù† Ø³Ø±ÛŒØ¹ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
git log --oneline --decorate -n 15
npm run    # Ø¯ÛŒØ¯Ù† Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§
npm run check || echo "no check script"
npm test   || echo "no tests"
```

---

## Troubleshooting (Ø±ÙØ¹ Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬)

### âš  Ø¨Ø§Øª Ù¾Ø§Ø³Ø® Ù†Ù…ÛŒâ€ŒØ¯Ù‡Ø¯

* Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Bot Token Ù…Ø¹ØªØ¨Ø± Ø¨Ø§Ø´Ø¯
* `ADMIN_IDS` Ø±Ø§ Ø¯Ø±Ø³Øª ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ø¨Ø§Ø´ÛŒØ¯
* Ø§ØªØµØ§Ù„ Ø³Ø±ÙˆØ± Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø±Ù‚Ø±Ø§Ø± Ø¨Ø§Ø´Ø¯

### âš  Ù…Ø´Ú©Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù¾Ù†Ù„ 3x-ui

* URL Ù¾Ù†Ù„
* Ù¾ÙˆØ±Øª Ùˆ Ù…Ø³ÛŒØ± API
* Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ 3x-ui

---
